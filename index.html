<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Openstack : OpenStack Folsom (with Quantum) Installation Guide" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Openstack</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/joarder/Openstack">View on GitHub</a>

          <h1 id="project_title">Openstack</h1>
          <h2 id="project_tagline">OpenStack Folsom (with Quantum) Installation Guide</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/joarder/Openstack/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/joarder/Openstack/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>Controller Node Installation</h1>

<h2>MySQL Database configurations</h2>

<p><code>mysql -u root -p</code><br><code>CREATE DATABASE keystone;</code><br><code>GRANT ALL ON keystone.* TO 'keystone'@'%' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON keystone.* TO 'keystone'@'localhost' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON keystone.* TO 'keystone'@'192.168.0.9' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON keystone.* TO 'keystone'@'controller1-01' IDENTIFIED BY 'openstack';</code>  </p>

<p><code>CREATE DATABASE glance;</code><br><code>GRANT ALL ON glance.* TO 'glance'@'%' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON glance.* TO 'glance'@'localhost' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON glance.* TO 'glance'@'192.168.0.9' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON glance.* TO 'glance'@'controller1-01' IDENTIFIED BY 'openstack';</code>  </p>

<p><code>CREATE DATABASE cinder;</code><br><code>GRANT ALL ON cinder.* TO 'cinder'@'%' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON cinder.* TO 'cinder'@'localhost' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON cinder.* TO 'cinder'@'192.168.0.9' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON cinder.* TO 'cinder'@'controller1-01' IDENTIFIED BY 'openstack';</code>  </p>

<p><code>CREATE DATABASE quantum;</code><br><code>GRANT ALL ON quantum.* TO 'quantum'@'%' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON quantum.* TO 'quantum'@'localhost' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON quantum.* TO 'quantum'@'192.168.0.9' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON quantum.* TO 'quantum'@'controller1-01' IDENTIFIED BY 'openstack';</code>  </p>

<p><code>CREATE DATABASE nova;</code><br><code>GRANT ALL ON nova.* TO 'nova'@'%' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON nova.* TO 'nova'@'localhost' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON nova.* TO 'nova'@'192.168.0.9' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON nova.* TO 'nova'@'controller1-01' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON nova.* TO 'nova'@'192.168.0.11' IDENTIFIED BY 'openstack';</code><br><code>GRANT ALL ON nova.* TO 'nova'@'cn1-01' IDENTIFIED BY 'openstack';</code>  </p>

<h1>Network Node Installation</h1>

<h1>Compute Node Installation</h1>

<h3>Install and configure common services</h3>

<p><strong>Install telnet and SSH support for the compute node</strong></p>

<p><code>apt-get install telnet &amp;&amp; apt-get install openssh-server</code></p>

<p><strong>Upload the latest iproute package and install it using dpkg</strong><br>
This package update is necessary if you want to use process network namespace in future for your quantum configuration</p>

<p><code>dpkg -i iproute_20121211-2_amd64.deb</code></p>

<p><strong>Include Cloud Archives for Folsom in the system</strong></p>

<p><code>apt-get install ubuntu-cloud-keyring</code><br><code>vi /etc/apt/sources.list.d/cloud-archive.list</code><br><code>deb http://ubuntu-cloud.archive.canonical.com/ubuntu precise-updates/folsom main</code>  </p>

<p><strong>Update the system</strong></p>

<p><code>apt-get update &amp;&amp; apt-get dist-upgrade &amp;&amp; apt-get upgrade</code></p>

<p><strong>Install VLAN and Bridge utilities and configure NIC to support multiple networks</strong></p>

<p><code>apt-get install -y vlan bridge-utils</code><br><code>vi /etc/network/interfaces</code>  </p>

<p><code># The loopback network interface</code><br><code>auto lo</code><br><code>iface lo inet loopback</code>  </p>

<p><code># Management Network Connected to VLAN 10</code><br><code>auto eth0</code><br><code>iface eth0 inet static</code><br><code>address 192.168.0.11</code><br><code>netmask 255.255.255.224</code><br><code>gateway 192.168.0.1</code><br><code>dns-nameservers 4.2.2.1 4.2.2.2</code>  </p>

<p><code># VM Configuration Network (Connected to VLAN 101)</code><br><code>auto eth0.101</code><br><code>iface eth0.101 inet static</code><br><code>vlan-raw-device eth0</code><br><code>address 10.0.0.11</code><br><code>netmask 255.255.255.0</code>  </p>

<p><strong>Install and configure NTP</strong><br><code>apt-get install -y ntp</code><br><code>sed -i 's/server ntp.ubuntu.com/server ntp.ubuntu.com\nserver 127.127.1.0\nfudge 127.127.1.0 stratum 10/g' /etc/ntp.conf</code><br><code>service ntp restart</code></p>

<p><strong>Edit /etc/sysctl.conf</strong></p>

<p><code>vi /etc/sysctl.conf</code><br><code>net.ipv4.conf.all.rp_filter = 0</code><br><code>net.ipv4.conf.default.rp_filter = 0</code><br><code>net.ipv4.ip_forward=1</code>  </p>

<p><em>If you do not want to reboot the system then just type</em></p>

<p><code>sysctl -p</code></p>

<p><strong>Add the below lines to your .bashrc file</strong> </p>

<p><code>vi ~/.bashrc</code></p>

<p><code>export OS_TENANT_NAME=ADMIN</code><br><code>export OS_USERNAME=admin</code><br><code>export OS_PASSWORD=openstack</code><br><code>export OS_AUTH_URL="http://192.168.0.9:5000/v2.0/"</code><br><code>export OS_AUTH_STRATEGY=keystone</code><br><code>export SERVICE_TOKEN=ADMIN</code><br><code>export SERVICE_ENDPOINT=http://192.168.0.9:35357/v2.0/</code></p>

<p><strong>Reboot the system</strong></p>

<p>It will be better to reboot the system at this point to make the effects into the configurations</p>

<p><code>reboot</code></p>

<h3>Install and configure KVM Hypervisor</h3>

<p><strong>Install the required packages</strong><br><code>apt-get install -y kvm libvirt-bin pm-utils</code>  </p>

<p><strong>Configure libvirt</strong><br>
Edit /etc/libvirt/qemu.conf file and add :<br><code>vi /etc/libvirt/qemu.conf</code><br><code>cgroup_device_acl = [</code><br><code>"/dev/null", "/dev/full", "/dev/zero",</code><br><code>"/dev/random", "/dev/urandom",</code><br><code>"/dev/ptmx", "/dev/kvm", "/dev/kqemu",</code><br><code>"/dev/rtc", "/dev/hpet", "/dev/net/tun"]</code>  </p>

<p><strong>Disable KVM default virtual bridge to avoid any confusion</strong><br><code>virsh net-destroy default</code><br><code>virsh net-undefine default</code>  </p>

<p><strong>Allow Live Migrations</strong><br>
Edit /etc/libvirt/libvirtd.conf file :<br><code>vi /etc/libvirt/libvirtd.conf</code><br><code>listen_tls = 0'  
</code>listen_tcp = 1<code>
</code>auth_tcp = "none"`  </p>

<p><strong>Modify libvirtd_opts variable in /etc/init/libvirt-bin.conf file</strong><br><code>vi /etc/init/libvirt-bin.conf</code><br><code>env libvirtd_opts="-d -l"</code>  </p>

<p><strong>Edit /etc/default/libvirt-bin file</strong><br><code>vi /etc/default/libvirt-bin</code><br><code>libvirtd_opts="-d -l"</code>  </p>

<p><strong>Restart libvirt</strong><br><code>service libvirt-bin restart</code>  </p>

<h3>Install and configure OpenVSwitch</h3>

<p><strong>Install the openVSwitch</strong><br><code>apt-get install -y openvswitch-switch openvswitch-datapath-dkms</code>  </p>

<p><strong>Create the bridges (br-int will be used for VM integration)</strong><br><code>ovs-vsctl add-br br-int</code>  </p>

<p><code>vi /etc/nova/nova.conf</code>  </p>

<p><code>[DEFAULT]</code><br><code>logdir=/var/log/nova</code><br><code>state_path=/var/lib/nova</code><br><code>lock_path=/run/lock/nova</code><br><code>verbose=True</code><br><code>api_paste_config=/etc/nova/api-paste.ini</code><br><code>scheduler_driver=nova.scheduler.simple.SimpleScheduler</code><br><code>s3_host=192.168.0.9</code><br><code>ec2_host=192.168.0.9</code><br><code>ec2_dmz_host=192.168.0.9</code><br><code>rabbit_host=192.168.0.9</code><br><code>cc_host=192.168.0.9</code><br><code>dmz_cidr=169.254.169.254/32</code><br><code>metadata_host=192.168.0.9</code><br><code>metadata_listen=0.0.0.0</code><br><code>nova_url=http://192.168.0.9:8774/v1.1/</code><br><code>sql_connection=mysql://nova:openstack@192.168.0.9/nova</code><br><code>ec2_url=http://192.168.0.9:8773/services/Cloud</code><br><code>root_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf</code><br><code># Authentication</code><br><code>use_deprecated_auth=false</code><br><code>auth_strategy=keystone</code><br><code>keystone_ec2_url=http://192.168.0.9:5000/v2.0/ec2tokens</code><br><code># Imaging service</code><br><code>glance_api_servers=192.168.0.9:9292</code><br><code>image_service=nova.image.glance.GlanceImageService</code><br><code># VNC configuration</code><br><code>novnc_enabled=true</code><br><code>novncproxy_base_url=http://192.168.0.130:6080/vnc_auto.html</code><br><code>novncproxy_port=6080</code><br><code>vncserver_proxyclient_address=192.168.0.11</code><br><code>vncserver_listen=0.0.0.0</code><br><code># Network settings</code><br><code>network_api_class=nova.network.quantumv2.api.API</code><br><code>quantum_url=http://192.168.0.9:9696</code><br><code>quantum_auth_strategy=keystone</code><br><code>quantum_admin_tenant_name=service</code><br><code>quantum_admin_username=quantum</code><br><code>quantum_admin_password=openstack</code><br><code>quantum_admin_auth_url=http://192.168.0.9:35357/v2.0</code><br><code>libvirt_vif_driver=nova.virt.libvirt.vif.LibvirtHybridOVSBridgeDriver</code><br><code>linuxnet_interface_driver=nova.network.linux_net.LinuxOVSInterfaceDriver</code><br><code>firewall_driver=nova.virt.libvirt.firewall.IptablesFirewallDriver</code><br><code># Compute</code><br><code>compute_driver=libvirt.LibvirtDriver</code><br><code># Cinder</code><br><code>volume_api_class=nova.volume.cinder.API</code><br><code>osapi_volume_listen_port=5900</code>  </p>

<h1>Credits:</h1>

<ol>
<li><a href="http://docs.openstack.org/folsom/basic-install/content/">Official Guide: Basic Installation Guide for Ubuntu 12.04/12.10 (Folsom)</a></li>
<li><a href="http://docwiki.cisco.com/wiki/Cisco_OpenStack_Edition:_Folsom_Manual_Install">Cisco OpenStack Edition: Folsom Manual Install</a></li>
<li><a href="https://github.com/mseknibilel/OpenStack-Folsom-Install-guide/blob/stable/GRE/OpenStack_Folsom_Install_Guide_WebVersion.rst">Folsom + Quantum on GRE-Tunneling with 3 NIC</a></li>
</ol>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Openstack maintained by <a href="https://github.com/joarder">joarder</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
